<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.15.4" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39629,5511215972" ReportOptions.Description.Text="" ReportOptions.LastChange="44700,6983744097" ScriptLanguage="PascalScript" ScriptText.Text="function GetType(): string;&#13;&#10;var&#13;&#10;  t: string;                              &#13;&#10;begin&#13;&#10;  t := &#60;aType&#62;;&#13;&#10;  if Copy(t, 1, 5) &#60;&#62; 'arch-' then&#13;&#10;  begin&#13;&#10;    Result := 'x-non-exists';&#13;&#10;    exit;                &#13;&#10;  end;            &#13;&#10;  Result := 'doc-' + Copy(t, 6, 99);                              &#13;&#10;end;&#13;&#10;&#13;&#10;function GetTypeCaption(): string;&#13;&#10;var&#13;&#10;  t: string;                              &#13;&#10;begin&#13;&#10;  t := &#60;aType&#62;;&#13;&#10;&#13;&#10;  if t = 'arch-acc-invoice' then&#13;&#10;  begin&#13;&#10;    Result := 'ñ÷åòîâ-ôàêòóð';&#13;&#10;    Exit;                &#13;&#10;  end;&#13;&#10;    &#13;&#10;  if t = 'arch-act-exec-works' then&#13;&#10;  begin&#13;&#10;    Result := 'àêòîâ';&#13;&#10;    Exit;                &#13;&#10;  end;&#13;&#10;    &#13;&#10;  if t = 'arch-cash-memo' then&#13;&#10;  begin&#13;&#10;    Result := 'òîâàðíûõ ÷åêîâ';&#13;&#10;    Exit;                &#13;&#10;  end;&#13;&#10;    &#13;&#10;  if t = 'arch-contract-goods' then&#13;&#10;  begin&#13;&#10;    Result := 'äîãîâîðîâ';&#13;&#10;    Exit;                &#13;&#10;  end;&#13;&#10;    &#13;&#10;  if t = 'arch-invoice' then&#13;&#10;  begin&#13;&#10;    Result := 'ñ÷åòîâ';&#13;&#10;    Exit;                &#13;&#10;  end;&#13;&#10;    &#13;&#10;  if t = 'arch-waybill' then&#13;&#10;  begin&#13;&#10;    Result := 'íàêëàäíûõ';&#13;&#10;    Exit;                &#13;&#10;  end;&#13;&#10;    &#13;&#10;end;            &#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403D40103546F70021008446174617365747301010C2600000020446174615365743D22717279446F632220446174615365744E616D653D22717279446F632200010C2800000020446174615365743D22717279417263682220446174615365744E616D653D22717279417263682200010C2800000020446174615365743D22717279446174652220446174615365744E616D653D2271727944617465220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxUIBQuery Name="qryDoc" UserName="qryDoc" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT &#13;&#10;  r_Doc.&#34;fObject&#34; &#34;fObject&#34;,&#13;&#10;  r_Doc.&#34;fType&#34; &#34;fType&#34;,&#13;&#10;  r_Doc.&#34;fFirm&#34; &#34;fFirm&#34;,&#13;&#10;  r_Doc.&#34;fPartner&#34; &#34;fPartner&#34;,&#13;&#10;  r_Doc.&#34;fDate&#34; &#34;fDate&#34;,&#13;&#10;  r_Doc.&#34;fName&#34; &#34;fName&#34;,      &#13;&#10;  CAST(NULLIF(r_Doc_X.&#34;fV0&#34;, '') AS TIMESTAMP) &#34;fFrom&#34;,&#13;&#10;  CAST(NULLIF(r_Doc_X.&#34;fV1&#34;, '') AS TIMESTAMP) &#34;fTo&#34;,&#13;&#10;  r_Doc_X.&#34;fV2&#34; &#34;fPayState&#34;,  &#13;&#10;  coalesce(r_Doc_X.&#34;fV3&#34;, '') &#34;fTagsFilter&#34;                                 &#13;&#10;FROM&#13;&#10;  &#34;tDoc&#34; r_Doc&#13;&#10;JOIN&#13;&#10;  &#34;tExtend&#34; r_Doc_X on (r_Doc_X.&#34;fOwner&#34; = CASE WHEN EXISTS (SELECT 1 FROM &#34;tExtend&#34; WHERE &#34;fOwner&#34; = r_Doc.&#34;fObject&#34;) THEN r_Doc.&#34;fObject&#34; ELSE '000000000000' END)&#13;&#10;where&#13;&#10;  r_Doc.&#34;fObject&#34; = :aObject                                                " TransList.Text="" Aggregates.Text="" PropData="05704C65667402300470546F7002300A506172616D657465727301010C24000000204E616D653D22614F626A656374222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxUIBQuery Name="qryArch" UserName="qryArch" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT &#13;&#10;  coalesce(rGoods.&#34;fObject&#34;, '000000000000') &#34;fObject&#34;,&#13;&#10;  r_Doc.&#34;fObject&#34; &#34;fDoc&#34;,&#13;&#10;  rGoods.&#34;fPrice&#34;,&#13;&#10;  rGoods.&#34;fPriceDC&#34;,&#13;&#10;  rGoods.&#34;fCount&#34;,&#13;&#10;  rGoods.&#34;fNDS&#34;,&#13;&#10;  rGoods.&#34;fNDSMode&#34;,&#13;&#10;  r_Doc.&#34;fSumMethod&#34; &#34;fDocSumMethod&#34;,&#13;&#10;  r_Doc.&#34;fPrecision&#34; &#34;fDocPrecision&#34;,&#13;&#10;  r_Doc.&#34;fByCurr&#34; &#34;fDocByCurr&#34;,&#13;&#10;  r_Doc.&#34;fCurr&#34; &#34;fDocCurr&#34;,&#13;&#10;  rGoods.&#34;fModel&#34;,&#13;&#10;  case when rGoods.&#34;fQName&#34; = '' then rModel.&#34;fName&#34; else rGoods.&#34;fQName&#34; end &#34;fModelName&#34;,      &#13;&#10;  rModel.&#34;fCurr&#34; &#34;fModelCurr&#34;,      &#13;&#10;  rModel.&#34;fCurr&#34; &#34;fGoodsCurr&#34;,&#13;&#10;  rVolume.&#34;fName&#34; &#34;fVolumeName&#34;,&#13;&#10;  rGroup.&#34;fName&#34; &#34;fGroupName&#34;,      &#13;&#10;&#13;&#10;  r_Doc.&#34;fType&#34; &#34;fDocType&#34;,&#13;&#10;  r_Doc.&#34;fFirm&#34; &#34;fDocFirm&#34;,&#13;&#10;  r_Doc_Firm.&#34;fFullName&#34; &#34;fDocFirmName&#34;,&#13;&#10;  r_Doc.&#34;fPartner&#34; &#34;fDocPartner&#34;,&#13;&#10;  r_Doc_Partner.&#34;fFullName&#34; &#34;fDocPartnerName&#34;,&#13;&#10;  r_Doc.&#34;fDate&#34; &#34;fDocDate&#34;,&#13;&#10;  r_Doc.&#34;fName&#34; &#34;fDocName&#34;,&#13;&#10;  r_Doc.&#34;fSum&#34; &#34;fDocSum&#34;  &#13;&#10;from      &#13;&#10;  &#34;tDoc&#34; r_Doc&#13;&#10;left outer join&#13;&#10;  &#34;tFirm&#34; r_Doc_Firm ON (r_Doc_Firm.&#34;fObject&#34; = r_Doc.&#34;fFirm&#34;)&#13;&#10;left outer join&#13;&#10;  &#34;tFirm&#34; r_Doc_Partner ON (r_Doc_Partner.&#34;fObject&#34; = r_Doc.&#34;fPartner&#34;)&#13;&#10;left outer join&#13;&#10;  &#34;tExtend&#34; r_Doc_X on (r_Doc_X.&#34;fOwner&#34; = CASE WHEN EXISTS (SELECT 1 FROM &#34;tExtend&#34; WHERE &#34;fOwner&#34; = r_Doc.&#34;fObject&#34;) THEN r_Doc.&#34;fObject&#34; ELSE '000000000000' END)&#13;&#10;left outer join&#13;&#10;  &#34;tGoods&#34; rGoods on (rGoods.&#34;fDoc&#34; = r_Doc.&#34;fObject&#34;)              &#13;&#10;left outer join&#13;&#10;  &#34;tModel&#34; rModel on (rModel.&#34;fObject&#34; = rGoods.&#34;fModel&#34;)&#13;&#10;left outer join&#13;&#10;  &#34;tGroup&#34; rGroup on (rGroup.&#34;fObject&#34; = rModel.&#34;fGroup&#34;)      &#13;&#10;left outer join&#13;&#10;  &#34;tVolume&#34; rVolume on (rVolume.&#34;fObject&#34; = rGoods.&#34;fVolume&#34;)&#13;&#10;[JFilter_TagDesc(qryDoc['fTagsFilter'])]  &#13;&#10;where&#13;&#10;  r_Doc.&#34;fType&#34; = :GetType  &#13;&#10;  and r_Doc.&#34;fMark&#34; = '1'                      &#13;&#10;  [NNVL(qryDoc['fFrom'], 'and r_Doc.&#34;fDate&#34; &#62;= ?')]      &#13;&#10;  [NNVL(qryDoc['fFirm'], 'and r_Doc.&#34;fFirm&#34; = ?')]&#13;&#10;  [NNVL(qryDoc['fPartner'], 'and r_Doc.&#34;fPartner&#34; = ?')]      &#13;&#10;  [NNVL(qryDoc['fTo'], 'and r_Doc.&#34;fDate&#34; &#60;= ?')]&#13;&#10;  [NNVL(qryDoc['fPayState'], 'and ? containing (SELECT &#34;oState&#34; FROM &#34;pDocGetPaymentState&#34;(r_Doc.&#34;fObject&#34;))')]&#13;&#10;  [WFilter_TagDesc(qryDoc['fTagsFilter'])]      &#13;&#10;order by&#13;&#10;  r_Doc_Firm.&#34;fFullName&#34;,&#13;&#10;  r_Doc.&#34;fFirm&#34;,&#13;&#10;  r_Doc.&#34;fNum&#34;,  &#13;&#10;  r_Doc.&#34;fDate&#34;,&#13;&#10;  r_Doc.&#34;fObject&#34;,&#13;&#10;  rGoods.&#34;fOrderA&#34;      &#13;&#10;        " TransList.Text="GoodsCost" Aggregates.Text="" PropData="05704C65667402740470546F7002300A506172616D657465727301010C24000000204E616D653D2247657454797065222044617461547970653D226674556E6B6E6F776E220000"/>
    <TfrxUIBQuery Name="qryDate" UserName="qryDate" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT&#13;&#10;  Min(r_Doc.&#34;fObject&#34;) &#34;fObject&#34;,                    &#13;&#10;  Max(r_Doc.&#34;fDate&#34;) &#34;fLastDate&#34;,&#13;&#10;  Min(r_Doc.&#34;fDate&#34;) &#34;fFirstDate&#34;           &#13;&#10;FROM&#13;&#10;  &#34;tDoc&#34; r_Doc&#13;&#10;where&#13;&#10;  r_Doc.&#34;fType&#34; = :GetType  &#13;&#10;  [NNVL(qryDoc['fFrom'], 'and r_Doc.&#34;fDate&#34; &#62;= ?')]      &#13;&#10;  [NNVL(qryDoc['fFirm'], 'and r_Doc.&#34;fFirm&#34; = ?')]&#13;&#10;  [NNVL(qryDoc['fPartner'], 'and r_Doc.&#34;fPartner&#34; = ?')]      &#13;&#10;  [NNVL(qryDoc['fTo'], 'and r_Doc.&#34;fDate&#34; &#60;= ?')]&#13;&#10;    " TransList.Text="" Aggregates.Text="" PropData="05704C6566740304010470546F7002300A506172616D657465727301010C24000000204E616D653D2247657454797065222044617461547970653D226674556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page2" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="15" RightMargin="10" TopMargin="10" BottomMargin="10" Columns="1" ColumnWidth="0" ColumnPositions.Text="0" HGuides.Text="56,69295" VGuides.Text="" OnBeforePrint="Page2OnBeforePrint">
    <TfrxReportTitle Name="Band1" Height="37,7952755905512" Left="0" Top="18,89765" Width="699,21305">
      <TfrxMemoView Name="Memo1" Left="0" Top="7,55905512" Width="699,21305" Height="18,8976378" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="CÐ¿Ð¸ÑÐ¾Ðº [GetTypeCaption()] Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ñ [IIF(qryDoc['fFrom'] &#62; 1, qryDoc['fFrom'], qryDate['fFirstDate'])] Ð¿Ð¾ [IIF(qryDoc['fTo'] &#62; 1, qryDoc['fTo'], qryDate['fLastDate'])]"/>
    </TfrxReportTitle>
    <TfrxGroupHeader Name="Band3" Height="18,8976378" Left="0" Top="117,16543" Width="699,21305" Condition="qryArch.&#34;fDocFirm&#34;" Stretched="True">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="699,21305" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÐµÐ»ÑŒ: [qryArch['fDocFirmName']]"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="Band7" Height="18,8976378" Left="0" Top="404,40971" Width="699,21305" Stretched="True">
      <TfrxMemoView Name="Memo17" Left="0" Top="0" Width="699,21305" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haRight" ParentFont="False" Text="Ð˜Ñ‚Ð¾Ð³Ð¾ Ð¿Ð¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÐµÐ»ÑŽ: [fm(Sum(qryArch['$Sum'], MasterData1))]"/>
    </TfrxGroupFooter>
    <TfrxReportSummary Name="Band8" Height="18,8976378" Left="0" Top="483,77984" Width="699,21305">
      <TfrxMemoView Name="Memo9" Left="0" Top="0" Width="699,21305" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haRight" ParentFont="False" Text="Ð˜Ñ‚Ð¾Ð³Ð¾ Ð¿Ð¾ Ð²ÑÐµÐ¼ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ð¼: [fm(Sum(qryArch['$Sum'], MasterData1))]"/>
    </TfrxReportSummary>
    <TfrxPageFooter Name="Band9" Height="18,8976378" Left="0" Top="525,35467" Width="699,21305">
      <TfrxMemoView Name="Memo21" Left="566,929133858268" Top="0" Width="132,283464566929" Height="18,8976378" ShowHint="False" HAlign="haRight" Text="[Page]"/>
    </TfrxPageFooter>
    <TfrxChild Name="Child2" Height="56,6929133858268" Left="0" Top="325,03958" Width="699,21305" PrintChildIfInvisible="True">
      <TfrxMemoView Name="Memo7" Left="566,92913386" Top="0" Width="132,28346457" Height="18,8976378" ShowHint="False" Frame.Typ="15" HAlign="haRight" Text="[fm(Sum(qryArch['$Sum']))]"/>
      <TfrxMemoView Name="Memo26" Left="472,44125" Top="0" Width="94,48825" Height="18,8976378" ShowHint="False" Frame.Typ="15" HAlign="haRight" Text="[Sum(qryArch['fCount'])]"/>
      <TfrxMemoView Name="Memo27" Left="0" Top="0" Width="472,44125" Height="18,8976378" ShowHint="False" Frame.Typ="15" HAlign="haRight" Text="Ð˜Ñ‚Ð¾Ð³Ð¾:"/>
      <TfrxMemoView Name="Memo6" Left="0" Top="18,89765" Width="699,21305" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" HAlign="haRight" Text="Ð’ Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ ÐÐ”Ð¡ [fm(Sum(qryArch['$SumN']))]"/>
    </TfrxChild>
    <TfrxGroupHeader Name="GroupHeader1" Height="37,79527559" Left="0" Top="158,74026" Width="699,21305" Child="Child1" Condition="qryArch.&#34;fDoc&#34;" Stretched="True">
      <TfrxMemoView Name="Memo4" Left="0" Top="0" Width="699,21305" Height="37,79527559" ShowHint="False" StretchMode="smMaxHeight" Text="â„– [qryArch['fDocName']] Ð¾Ñ‚ [qryArch['fDocDate'] #Ddd.mm.yyyy] &#13;&#10;ÐŸÐ¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»ÑŒ: [qryArch['fDocPartnerName']]"/>
    </TfrxGroupHeader>
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="260,78757" Width="699,21305" ColumnWidth="0" ColumnGap="0" DataSet="qryArch" DataSetName="qryArch" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo12" Left="0" Top="0" Width="340,15745591" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" DataSetName="qryGoods" Frame.Typ="15" Text="[qryArch['fModelName']]"/>
      <TfrxMemoView Name="Memo14" Left="340,1577" Top="0" Width="132,28348898" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haRight" Text="[qryArch['fGroupName']]"/>
      <TfrxMemoView Name="Memo15" Left="566,9295" Top="0" Width="132,28346457" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haRight" Text="[fm(qryArch['$Sum'])]"/>
      <TfrxMemoView Name="Memo3" Left="472,44125" Top="0" Width="94,48818898" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" DataSetName="qryGoods" Frame.Typ="15" HAlign="haRight" Text="[qryArch['fCount']]"/>
    </TfrxMasterData>
    <TfrxGroupFooter Name="GroupFooter1" Height="0" Left="0" Top="302,3624" Width="699,21305" Child="Child2"/>
    <TfrxChild Name="Child1" Height="18,8976378" Left="0" Top="219,21274" Width="699,21305">
      <TfrxMemoView Name="Memo22" Left="0" Top="0" Width="340,15745591" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ"/>
      <TfrxMemoView Name="Memo23" Left="340,1577" Top="0" Width="132,28348898" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Ð“Ñ€ÑƒÐ¿Ð¿Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²"/>
      <TfrxMemoView Name="Memo24" Left="566,9295" Top="0" Width="132,28346457" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Ð¡ÑƒÐ¼Ð¼Ð° Ñ ÐÐ”Ð¡"/>
      <TfrxMemoView Name="Memo25" Left="472,44125" Top="0" Width="94,48818898" Height="18,8976378" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾"/>
    </TfrxChild>
  </TfrxReportPage>
</TfrxReport>
